(()=>{"use strict";const e=document.querySelector(".add-task"),t=document.querySelector("#enter-task"),a=document.querySelector("#group-name"),r=document.querySelector("#group-container"),n=document.querySelector(".add-group"),i=document.querySelector("#delete-group"),s=document.querySelector("#gErrMsg"),d=document.querySelector("#submit-task"),o=document.querySelector("#task-name"),c=document.querySelector("#due-date"),l=document.querySelector("#select-priority"),u=document.querySelector("#describe-task"),p=document.querySelector(".task-box"),m=(document.querySelector(".fa-edit"),document.querySelector("#del-task"),document.querySelector(".form-title")),y=document.querySelector("#update-task"),v=document.querySelector("#sort-item");let g;document.querySelector(".task-box-div");const S=[{id:Date.now().toString(),name:"Travelling",tasks:[{name:"Travell to Lagos",dueDate:"2020-01-15",description:"Attend an interview for a big job",priority:"High"}]},{id:Date.now().toString(),name:"Study",tasks:[{name:"Study JavaSCript Arrays",dueDate:"2020-01-20",description:"Studying this topic is crucial to my next project",priority:"Medium"}]}],f=()=>{localStorage.setItem("myTodoArray",JSON.stringify(g))},k=()=>{g=localStorage.getItem("myTodoArray")?JSON.parse(localStorage.getItem("myTodoArray")):S},L=()=>{k(),r.innerHTML="",g.forEach((e=>{const t=`\n    <p id=${e.id}>${e.name}</p>`;r.insertAdjacentHTML("afterbegin",t)}))},b=(e,t)=>e.findIndex((e=>e.id===t)),E=(e,t)=>{const a=b(e,t);e.splice(a,1),f()},D=()=>({id:Date.now().toString(),name:o.value,dateDue:c.value,priority:l.value,describe:u.value}),h=e=>{k(),p.innerHTML="",e.forEach((e=>{const t=`\n      <div class='task-box-div' id='tb-${e.id}'><h5 class='t-title' id='pt-${e.id}'><span>Title:</span> ${e.name}</h5></br>\n      <textarea class='t-describe'>${e.describe}</textarea><p class='t-priority'><span>Priority:</span> ${e.priority}</p>\n      <div class='edit-box'><p class='due-date'><span>Due Date:</span> ${e.dateDue}</p><div class='task-edit'><i class="fa fa-edit" id='${e.id}e'></i>\n      <i class='fa fa-trash-o' id='${e.id}d'></i>\n      </div></div></div></br>`;p.insertAdjacentHTML("afterbegin",t)}))},q=(e,t)=>e[b(e,t)].tasks,T=(e,t)=>{const a=t.priority,r=e.priority;let n=0;return a>r?n=1:a<r&&(n=-1),n},M=(e,t)=>{const a=t.dateDue,r=e.dateDue;let n=0;return a>r?n=1:a<r&&(n=-1),n};let H="",$="",x="",A="",I=!1;document.addEventListener("DOMContentLoaded",(()=>{t.classList.add("no-display"),L()})),e.addEventListener("click",(()=>{t.classList.toggle("no-display"),y.style.display="none"})),n.addEventListener("submit",(e=>{e.preventDefault(),(()=>{const e={id:Date.now().toString(),name:a.value.toUpperCase(),tasks:[]},t=e.name;0!==g.length&&""!==((e,t)=>{let a="";if(0!==e.length&&null!==e)return e.forEach((r=>{r.name===t&&(a=e.indexOf(t))})),a})(g,t)||""===a.value?(s.innerHTML="Duplicate or Empty Group Name not Allowed",s.classList.add("group-duplicate"),a.classList.add("red-border")):(k(),g.push(e),f(),s.innerHTML="",a.classList.remove("red-border"))})(),L()})),r.addEventListener("click",(e=>{var t;e.preventDefault(),t=e.target.innerHTML,p.innerHTML="",g.forEach((e=>{if(t===e.name){H=e.id;const t=e.tasks;$=document.getElementById(H),$.classList.add("active-group"),h(t),I=!0,q(g,H).length>=2?v.style.display="block":v.style.display="none"}else x=e.id,A=document.getElementById(x),A.classList.remove("active-group")}))})),i.addEventListener("click",(()=>{I&&E(g,H),I=!1,L()})),d.addEventListener("click",(()=>{((e,t)=>{const a=e[b(e,t)];if(""!==o.value&&""!==c.value&&""!==u.value){const e=D();a.tasks.push(e),f()}h(a.tasks)})(g,H)})),p.addEventListener("click",(e=>{e.preventDefault();const a=e.target.className,r=e.target.id,n=e.target.parentElement.id,i=r.slice(0,r.length-1),s=q(g,H);s.forEach((e=>{if("fa fa-trash-o"===a&&i===e.id){const t=e.id;E(s,t),h(s)}if("fa fa-edit"===a&&i===e.id){m.innerHTML="Edit Task",d.style.display="none";const a=e.id;((e,a)=>{const r=e[b(e,a)];o.value=r.name,c.value=r.dateDue,l.value=r.priority,u.value=r.describe,t.style.display="block"})(s,a),y.addEventListener("click",(()=>{((e,t)=>{const a=b(e,t),r=D();e.splice(a,1,r),f()})(s,a),h(s)}))}const p=document.getElementById(n),v=r.slice(3,r.length);e.id===v&&p.classList.toggle("task-div")}))})),v.addEventListener("change",(e=>{var t,a;e.preventDefault(),t=q(g,H),"priority"===(a=v.value)&&h(t.sort(T)),"dateDue"===a&&h(t.sort(M))}))})();