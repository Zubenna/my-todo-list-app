(()=>{"use strict";const e=document.querySelector(".add-task"),t=document.querySelector(".form-title"),a=document.querySelector("#update-task"),r=document.querySelector("#sort-item"),i=document.querySelector(".add-group"),s=document.querySelector("#delete-group"),n=document.querySelector("#submit-task"),d=document.querySelector(".task-box"),o=document.querySelector("#enter-task"),c=document.querySelector("#group-name"),l=document.querySelector("#group-container"),u=document.querySelector("#gErrMsg"),m=document.querySelector("#task-name"),y=document.querySelector("#due-date"),p=document.querySelector("#select-priority"),v=document.querySelector("#describe-task");let g;document.querySelector(".fa-edit"),document.querySelector("#del-task"),document.querySelector(".task-box-div");const k=[{id:"3456",name:"Travelling",tasks:[{id:"7893455",name:"Travell to Lagos",dateDue:"2020-01-15",priority:"High",describe:"Attend an interview for a big job"}]},{id:"7865",name:"Study",tasks:[{id:"5768394",name:"Study JavaScript",dateDue:"2020-01-20",priority:"Medium",describe:"Studying this topic is crucial to my next project"}]}],S=()=>{localStorage.setItem("myTodoArray",JSON.stringify(g))},f=()=>{g=localStorage.getItem("myTodoArray")?JSON.parse(localStorage.getItem("myTodoArray")):k},L=()=>{f(),l.innerHTML="",g.forEach((e=>{const t=`\n    <p id=${e.id}>${e.name}</p>`;l.insertAdjacentHTML("afterbegin",t)}))},b=(e,t)=>e.findIndex((e=>e.id===t)),E=(e,t)=>{const a=b(e,t);return-1!==a&&e.splice(a,1),S(),e},h=(e,t,a,r,i)=>({id:e,name:t,dateDue:a,priority:r,describe:i}),q=e=>{f(),d.innerHTML="",e.forEach((e=>{const t=`\n      <div class='task-box-div' id='tb-${e.id}'><h5 class='t-title' id='pt-${e.id}'><span>Title:</span> ${e.name}</h5></br>\n      <textarea class='t-describe'>${e.describe}</textarea><p class='t-priority'><span>Priority:</span> ${e.priority}</p>\n      <div class='edit-box'><p class='due-date'><span>Due Date:</span> ${e.dateDue}</p><div class='task-edit'><i class="fa fa-edit" id='${e.id}e'></i>\n      <i class='fa fa-trash-o' id='${e.id}d'></i>\n      </div></div></div></br>`;d.insertAdjacentHTML("afterbegin",t)}))},D=(e,t)=>e[b(e,t)].tasks,T=(e,t)=>{const a=t.priority,r=e.priority;let i=0;return a>r?i=1:a<r&&(i=-1),i},M=(e,t)=>{const a=t.dateDue,r=e.dateDue;let i=0;return a>r?i=1:a<r&&(i=-1),i};let H="",$="",x="",A="",I=!1;document.addEventListener("DOMContentLoaded",(()=>{o.classList.add("no-display"),L()})),e.addEventListener("click",(()=>{o.classList.toggle("no-display"),a.style.display="none"})),i.addEventListener("submit",(e=>{e.preventDefault();const t={id:Date.now().toString(),name:c.value.toUpperCase(),tasks:[]};const a=t.name;0!==g.length&&""!==((e,t)=>{let a="";if(0!==e.length&&null!==e)return e.forEach((r=>{r.name===t&&(a=e.indexOf(t))})),a})(g,a)||""===c.value?(u.innerHTML="Duplicate or Empty Group Name not Allowed",u.classList.add("group-duplicate"),c.classList.add("red-border")):((e=>{f(),g.push(e),S()})(t),u.innerHTML="",c.classList.remove("red-border")),L()})),l.addEventListener("click",(e=>{var t;e.preventDefault(),t=e.target.innerHTML,d.innerHTML="",g.forEach((e=>{if(t===e.name){H=e.id;const t=e.tasks;$=document.getElementById(H),$.classList.add("active-group"),q(t),I=!0,D(g,H).length>=2?r.style.display="block":r.style.display="none"}else x=e.id,A=document.getElementById(x),A.classList.remove("active-group")}))})),s.addEventListener("click",(()=>{I&&E(g,H),I=!1,L()})),n.addEventListener("click",(()=>{const e=(t=g)[b(t,H)];var t,a,r;""!==m.value&&""!==y.value&&""!==v.value&&(a=e,r=h(Date.now().toString(),m.value,y.value,p.value,v.value),a.tasks.push(r),S(),q(a.tasks),a.tasks)})),d.addEventListener("click",(e=>{e.preventDefault();const r=e.target.className,i=e.target.id,s=e.target.parentElement.id,d=i.slice(0,i.length-1),c=D(g,H);c.forEach((e=>{if("fa fa-trash-o"===r&&d===e.id){const t=e.id;E(c,t),q(c)}if("fa fa-edit"===r&&d===e.id){t.innerHTML="Edit Task",n.style.display="none";const r=e.id;((e,t)=>{const a=e[b(e,t)];taskName.value=a.name,dueDate.value=a.dateDue,selectPriority.value=a.priority,describeTask.value=a.describe,o.style.display="block"})(c,r),a.addEventListener("click",(()=>{((e,t)=>{const a=b(e,t),r=h();e.splice(a,1,r),S()})(c,r),q(c)}))}const l=document.getElementById(s),u=i.slice(3,i.length);e.id===u&&l.classList.toggle("task-div")}))})),r.addEventListener("change",(e=>{var t,a;e.preventDefault(),t=D(g,H),"priority"===(a=r.value)&&q(t.sort(T)),"dateDue"===a&&q(t.sort(M))}))})();